import{_ as I,r as u,c as M,o as N,y as w,d as o,e,f as d,i as B,q as c,K as r,v as F,I as K,l as S,h as _,F as z,s as U,t as l,m as q,p as n,n as L,k as A}from"./index-D7KbY98F.js";const G={class:"product-management"},R={class:"toolbar"},j={class:"search-box"},H={class:"content-card"},J={key:0,class:"loading-state"},O={key:1,class:"empty-state"},Q={key:2,class:"product-table"},W={class:"product-image"},X=["src","alt"],Y={key:1,class:"no-image"},Z={class:"product-name"},ee={key:0,class:"product-desc"},te={class:"category-tag"},se={class:"price-cell"},ae={class:"current-price"},ne={key:0,class:"original-price"},oe={class:"stock-info"},le={class:"stock-number"},ie={class:"actions"},ce=["onClick"],re=["onClick"],de={key:3,class:"pagination"},ue=["disabled"],me=["disabled"],ve={__name:"ProductManagementView",setup(ge){const k=q(),p=u([]),h=u(!1),i=u(1),y=u(6),m=u(0),v=u(""),f=M(()=>Math.ceil(m.value/y.value)),x=a=>({1:"宠物食品",2:"宠物用品",3:"宠物玩具",4:"宠物服饰",5:"宠物医疗"})[a]||"-",b=a=>a?parseFloat(a).toFixed(2):"0.00",E=a=>{a.target.style.display="none",a.target.nextElementSibling.style.display="flex"};N(()=>{g()});async function g(){h.value=!0;try{const a={page:i.value,pageSize:y.value};v.value&&(a.keyword=v.value);const t=await w({url:"/api/admin/products",method:"GET",params:a});t.code===200&&(p.value=t.data.list||[],m.value=t.data.total||0)}catch(a){console.error("加载商品失败:",a)}finally{h.value=!1}}function P(){i.value=1,g()}function C(a){i.value=a,g()}function V(){k.push("/admin/products/add")}function $(a){k.push(`/admin/products/edit/${a.id}`)}async function D(a){if(confirm(`确定要删除商品"${a.name}"吗？此操作不可恢复。`))try{const t=await w({url:`/api/admin/products/${a.id}`,method:"DELETE"});t.code===200?(g(),alert("删除成功")):alert(t.message||"删除失败")}catch(t){console.error("删除失败:",t),alert("删除失败")}}return(a,t)=>(n(),o("div",G,[t[9]||(t[9]=e("div",{class:"page-header"},[e("h1",null,"商城管理"),e("p",null,"管理商品信息、库存和状态")],-1)),e("div",R,[e("div",j,[d(c(r),{icon:"mdi:magnify",class:"search-icon"}),B(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),placeholder:"搜索商品名称...",onKeyup:K(P,["enter"])},null,544),[[F,v.value]]),e("button",{class:"search-btn",onClick:P},"搜索")]),e("button",{class:"add-btn",onClick:V},[d(c(r),{icon:"mdi:plus"}),t[3]||(t[3]=S(" 添加商品 ",-1))])]),e("div",H,[h.value?(n(),o("div",J,[d(c(r),{icon:"mdi:loading",class:"spin"}),t[4]||(t[4]=e("span",null,"加载中...",-1))])):p.value.length===0?(n(),o("div",O,[d(c(r),{icon:"mdi:package-variant",class:"empty-icon"}),t[5]||(t[5]=e("h3",null,"暂无商品",-1)),t[6]||(t[6]=e("p",null,"点击上方按钮添加第一个商品",-1))])):(n(),o("table",Q,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"商品图片"),e("th",null,"商品名称"),e("th",null,"分类"),e("th",null,"价格"),e("th",null,"库存"),e("th",null,"操作")])],-1)),e("tbody",null,[(n(!0),o(z,null,U(p.value,s=>(n(),o("tr",{key:s.id},[e("td",null,[e("div",W,[s.imageUrl?(n(),o("img",{key:0,src:s.imageUrl,alt:s.name,onError:E},null,40,X)):(n(),o("div",Y,[d(c(r),{icon:"mdi:image"}),t[7]||(t[7]=e("span",null,"暂无图片",-1))]))])]),e("td",null,[e("div",Z,l(s.name),1),s.shortDescription?(n(),o("div",ee,l(s.shortDescription),1)):_("",!0)]),e("td",null,[e("span",te,l(x(s.categoryId)),1)]),e("td",se,[e("div",ae,"¥"+l(b(s.price)),1),s.originalPrice&&s.originalPrice>s.price?(n(),o("div",ne," ¥"+l(b(s.originalPrice)),1)):_("",!0)]),e("td",{class:L({"low-stock":s.stock<10})},[e("div",oe,[e("span",le,l(s.stock),1),s.stock<10?(n(),A(c(r),{key:0,icon:"mdi:alert",class:"warning-icon",title:"库存不足"})):_("",!0)])],2),e("td",null,[e("div",ie,[e("button",{class:"action-btn edit",onClick:T=>$(s),title:"编辑"},[d(c(r),{icon:"mdi:pencil"})],8,ce),e("button",{class:"action-btn delete",onClick:T=>D(s),title:"删除"},[d(c(r),{icon:"mdi:delete"})],8,re)])])]))),128))])])),m.value>y.value?(n(),o("div",de,[e("button",{disabled:i.value===1,onClick:t[1]||(t[1]=s=>C(i.value-1))},"上一页",8,ue),e("span",null,"第 "+l(i.value)+" / "+l(f.value)+" 页，共 "+l(m.value)+" 条",1),e("button",{disabled:i.value>=f.value,onClick:t[2]||(t[2]=s=>C(i.value+1))},"下一页",8,me)])):_("",!0)])]))}},pe=I(ve,[["__scopeId","data-v-dccfef86"]]);export{pe as default};
