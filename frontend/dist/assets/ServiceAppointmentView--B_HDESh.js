import{_ as xe,u as Te,r as f,c as b,B as ne,o as Fe,C as Re,d as n,e as t,h as v,l as d,i as oe,D as Ve,F as g,s as w,t as i,v as Ue,f as le,E as ie,g as Le,m as Be,p as o,n as C,w as Ee}from"./index-D7KbY98F.js";const Ye={class:"appointment-container"},Oe={class:"appointment-main-dual"},He={class:"left-section"},je={class:"appointment-form"},ze={class:"form-section"},qe=["disabled"],Ge=["value"],Je={key:0,class:"loading-small"},Ke={key:1,class:"no-data"},Qe={class:"form-section"},We={class:"calendar-container-main"},Xe={class:"calendar-header-main"},Ze={class:"calendar-weekdays-main"},et={class:"calendar-days-main"},tt=["onClick"],st={class:"day-number-main"},at={key:0,class:"appointment-indicator-main"},nt={class:"appointment-count"},ot={key:1,class:"today-indicator-main"},lt={key:0,class:"selected-date-display"},it={class:"form-section"},ct={key:0,class:"loading-small"},rt={key:1,class:"time-slots-main"},dt=["onClick"],ut={class:"time-slot-content"},vt={class:"time-text"},ft={key:0,class:"slot-status"},mt={key:1,class:"fas fa-check selected-icon"},pt={key:2,class:"no-data"},yt={class:"form-section"},_t={class:"char-count"},ht={class:"right-section"},gt={class:"appointment-form"},kt={class:"form-section"},Dt={key:0,class:"loading-small"},bt={key:1,class:"service-options-main"},wt=["onClick"],Ct={class:"service-icon-main"},St={class:"service-info-main"},It={class:"service-header"},At={key:0,class:"recommended-tag"},Nt={class:"service-desc"},$t={class:"service-footer"},Pt={class:"price-section"},Mt={key:0,class:"original-price-main"},xt={class:"final-price-main"},Tt={key:1,class:"discount-badge-main"},Ft={class:"duration-section"},Rt={key:2,class:"no-data"},Vt={class:"form-section"},Ut={key:0,class:"loading-small"},Lt={key:1,class:"care-items-container-main"},Bt={class:"care-category-title-main"},Et={class:"care-items-grid-main"},Yt=["onClick"],Ot={class:"care-item-header-main"},Ht={key:0,class:"care-price-main"},jt={key:1,class:"care-free-main"},zt={class:"care-description-main"},qt={class:"care-item-footer"},Gt={class:"selection-indicator"},Jt={key:0,class:"fas fa-check-circle"},Kt={key:1,class:"far fa-circle"},Qt={key:2,class:"selected-care-summary-main"},Wt={class:"care-total-price"},Xt={class:"middle-section"},Zt={key:0,class:"price-summary-main"},es={class:"summary-content"},ts={class:"summary-item-main"},ss={key:0,class:"summary-item-main"},as={class:"summary-total-main"},ns={class:"total-price-main"},os=["disabled"],ls={key:0,class:"fas fa-spinner fa-spin"},is={key:1,class:"fas fa-calendar-check"},cs={key:2,class:"submit-price"},rs={class:"appointment-history-section"},ds={class:"history-header"},us={key:0,class:"history-dual-layout"},vs={class:"history-left-column"},fs={class:"appointments-history-list compact"},ms={class:"appointment-history-header"},ps={class:"order-info"},ys={class:"order-id"},_s={class:"appointment-history-time compact-time"},hs={class:"appointment-history-body"},gs={class:"service-history-info compact-service"},ks={class:"service-history-details"},Ds={class:"pet-history-info"},bs={class:"price-history-info compact-price"},ws={class:"price-history-amount"},Cs={class:"amount"},Ss={class:"appointment-history-footer compact-footer"},Is=["onClick"],As=["onClick"],Ns=["onClick"],$s={class:"history-right-column"},Ps={class:"appointments-history-list compact"},Ms={class:"appointment-history-header"},xs={class:"order-info"},Ts={class:"order-id"},Fs={class:"appointment-history-time compact-time"},Rs={class:"appointment-history-body"},Vs={class:"service-history-info compact-service"},Us={class:"service-history-details"},Ls={class:"pet-history-info"},Bs={class:"price-history-info compact-price"},Es={class:"price-history-amount"},Ys={class:"amount"},Os={class:"appointment-history-footer compact-footer"},Hs=["onClick"],js=["onClick"],zs=["onClick"],qs={key:1,class:"loading-container"},Gs={key:2,class:"empty-history"},Js={key:3,class:"load-more-container"},Ks=["disabled"],Qs={key:0,class:"fas fa-spinner fa-spin"},Ws={key:1},Xs={key:0,class:"modal-overlay"},Zs={class:"modal-content"},ea={class:"modal-body"},ta={class:"success-details"},sa={class:"detail-item"},aa={class:"detail-value"},na={class:"detail-item"},oa={class:"detail-value"},la={class:"detail-item"},ia={class:"detail-value"},ca={class:"modal-footer"},ra={__name:"ServiceAppointmentView",setup(da){const V=Be(),_=Te(),l=f({petId:"",appointmentDate:"",timeSlot:"",serviceId:"",specialNotes:"",careItems:[]}),p=f([]),I=f([]),z=f(["09:00","10:30","14:00","15:30","17:00"]),A=f([]),y=f([]),N=f(null),k=f([]),h=f([]);f(1),f(4),f(!0);const q=f(!1),ce=b(()=>y.value.slice(0,4).slice(0,2)),re=b(()=>y.value.slice(0,4).slice(2,4)),r=f({pets:!1,services:!1,timeSlots:!1,appointments:!1,careItems:!1,appointmentStats:!1}),F=f(!1),D=f(new Date),E=["日","一","二","三","四","五","六"];b(()=>new Date().toISOString().split("T")[0]);const U=f(!1),R=f({}),Y=f({}),G=b(()=>l.value.petId&&l.value.appointmentDate&&l.value.timeSlot&&l.value.serviceId),de=b(()=>{const s=D.value.getFullYear(),e=D.value.getMonth()+1;return`${s}年${e}月`}),ue=b(()=>{const s=D.value.getFullYear(),e=D.value.getMonth(),c=new Date,a=new Date(s,e,1),u=new Date(s,e+1,0),M=a.getDay(),B=u.getDate(),S=[],T=new Date(s,e,0).getDate();for(let m=M;m>0;m--){const x=new Date(s,e-1,T-m+1);S.push({id:`prev-${m}`,date:x,isCurrentMonth:!1,isToday:!1,isSelected:!1,appointmentCount:0})}for(let m=1;m<=B;m++){const x=new Date(s,e,m),ae=$(x),$e=x.toDateString()===c.toDateString(),Pe=l.value.appointmentDate===ae,Me=Y.value[ae]||0;S.push({id:`current-${m}`,date:x,isCurrentMonth:!0,isToday:$e,isSelected:Pe,appointmentCount:Me})}const Ne=42-(M+B);for(let m=1;m<=Ne;m++){const x=new Date(s,e+1,m);S.push({id:`next-${m}`,date:x,isCurrentMonth:!1,isToday:!1,isSelected:!1,appointmentCount:0})}return S}),ve=b(()=>{const s=new Set;return k.value&&k.value.length>0&&k.value.forEach(e=>{e.careCategory&&s.add(e.careCategory)}),Array.from(s)});function fe(){V.push("/service/orders")}function me(s){return k.value.filter(e=>e.careCategory===s)}function J(s){return h.value.includes(s)}const O=b(()=>{if(h.value.length===0)return 0;let s=0;return h.value.forEach(e=>{const c=k.value.find(a=>a.id===e);c&&c.unitPrice&&(s+=parseFloat(c.unitPrice))}),s.toFixed(2)}),H=b(()=>{const s=N.value?parseFloat(N.value.finalPrice):0,e=parseFloat(O.value);return(s+e).toFixed(2)});function pe(s){if(!s)return"";const e=new Date(s),c=e.getFullYear(),a=e.getMonth()+1,u=e.getDate(),M=E[e.getDay()];return`${c}年${a}月${u}日 星期${M}`}function K(s){const e=new Date;e.setHours(0,0,0,0);const c=new Date(s);return c.setHours(0,0,0,0),c<e}function ye(s){return{洗澡:"fas fa-shower",美容:"fas fa-cut",护理:"fas fa-spa",医疗:"fas fa-bug"}[s]||"fas fa-paw"}function Q(s){if(!s)return"";const e=new Date(s),c=e.getMonth()+1,a=e.getDate(),u=E[e.getDay()];return`${c}月${a}日 星期${u}`}function $(s){const e=s.getFullYear(),c=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");return`${e}-${c}-${a}`}function W(s){return{pending:"待服务",confirmed:"已确认",completed:"已完成",cancelled:"已取消"}[s]||s}function X(s){V.push(`/service/appointment/${s}`)}function Z(s){V.push(`/service/review/${s}`)}async function P(){try{if(!_.isLoggedIn)return;const s=new Date,e=s.getFullYear(),c=s.getMonth(),a=new Date(e,c,1),u=new Date(e,c+1,0),M=$(a),B=$(u),S=await _.getDailyAppointmentCounts(M,B);S&&Array.isArray(S)&&S.forEach(T=>{T.appointment_date&&T.count!==void 0&&(Y.value[T.appointment_date]=T.count)})}catch(s){console.error("获取当月预约次数失败:",s)}}async function ee(){r.value&&(r.value.pets=!0);try{console.log("开始获取宠物列表...");const s=await _.getUserPets();console.log("获取到宠物列表原始数据:",s);let e=[];Array.isArray(s)?e=s:s&&typeof s=="object"&&(Array.isArray(s.data)?e=s.data:s.list&&(e=s.list)),e=e.map(c=>({id:parseInt(c.id)||c.id,name:c.name||"未命名",breed:c.breed||"未知品种",type:c.type||c.pet_type||"未知"})),console.log("格式化后宠物列表:",e),p.value=e,p.value.length>0&&!l.value.petId&&(l.value.petId=p.value[0].id.toString())}catch(s){console.error("获取宠物失败:",s),p.value=[],alert("获取宠物列表失败，请稍后重试")}finally{r.value&&(r.value.pets=!1)}}async function _e(){r.value&&(r.value.services=!0);try{console.log("开始获取服务项目...");const s=await _.getServiceItems();console.log("获取到服务项目原始数据:",s),Array.isArray(s)?(I.value=s.map(e=>({id:e.id,category:e.category||"其他",itemName:e.itemName||e.name||"未命名服务",briefDesc:e.briefDesc||e.description||"",basePrice:e.basePrice||e.price||0,isDiscount:e.isDiscount||!1,discountPercentage:e.discountPercentage||0,finalPrice:e.finalPrice||e.basePrice||0,duration:e.duration||60,isRecommended:e.isRecommended||!1,thumbnailUrl:e.thumbnailUrl||null,isSinglePurchase:e.isSinglePurchase||!1})),console.log("格式化后服务项目:",I.value)):(console.warn("服务项目数据不是数组:",s),I.value=[])}catch(s){console.error("获取服务项目失败:",s),I.value=[]}finally{r.value&&(r.value.services=!1)}}async function he(){r.value&&(r.value.careItems=!0);try{console.log("开始获取护理项目...");const s=await _.getCareItems();console.log("获取到护理项目原始数据:",s),Array.isArray(s)?(k.value=s.map(e=>({id:e.id,careName:e.careName||"未命名护理",careCategory:e.careCategory||"其他",description:e.description||"",unitPrice:e.unitPrice||0,isSinglePurchase:e.isSinglePurchase||!1})),console.log("格式化后护理项目:",k.value)):(console.warn("护理项目数据不是数组:",s),k.value=[])}catch(s){console.error("获取护理项目失败:",s),k.value=[]}finally{r.value&&(r.value.careItems=!1)}}async function L(s){if(s){r.value&&(r.value.timeSlots=!0);try{A.value=await _.getAvailableTimeSlots(s)}catch(e){console.error("获取可用时间段失败:",e),A.value=z.value}finally{r.value&&(r.value.timeSlots=!1)}}}async function j(){r.value&&(r.value.appointments=!0);try{const s=await _.getAllUserAppointments();Array.isArray(s)?y.value=s.slice(0,4).map(e=>({id:e.id,orderNo:e.orderNo||`ORD${e.id.toString().padStart(6,"0")}`,petName:e.petName||e.pet?.name||"未命名",serviceName:e.serviceName||e.service?.itemName||"未知服务",appointmentDate:e.appointmentDate||e.appointment_date,timeSlot:e.timeSlot||e.time_slot||"09:00",orderTotalAmount:e.orderTotalAmount||e.total_amount||0,status:e.status||"pending",reviewed:e.reviewed||e.has_review||!1})):y.value=[]}catch(s){console.error("获取预约记录失败:",s),y.value=[]}finally{r.value&&(r.value.appointments=!1)}}function te(s){return A.value.includes(s)}function ge(s){te(s)&&(l.value.timeSlot=s)}function ke(s){l.value.serviceId=s.id,N.value=s}function De(s){const e=h.value.indexOf(s.id);e===-1?h.value.push(s.id):h.value.splice(e,1),l.value.careItems=[...h.value]}function be(s){s.isCurrentMonth&&!K(s.date)&&(l.value.appointmentDate=$(s.date),L(l.value.appointmentDate))}function we(){const s=new Date(D.value);s.setMonth(s.getMonth()-1),D.value=s,P()}function Ce(){const s=new Date(D.value);s.setMonth(s.getMonth()+1),D.value=s,P()}function Se(){D.value=new Date;const s=$(new Date);l.value.appointmentDate=s,L(s),P()}async function se(s){if(confirm(`确定要取消预约 ${s.orderNo} 吗？`))try{await _.cancelAppointment(s.id,"用户主动取消"),alert("预约已取消");const e=y.value.findIndex(c=>c.id===s.id);e!==-1&&(y.value[e].status="cancelled"),await P()}catch(e){console.error("取消预约失败:",e),alert(e.message||"取消预约失败")}}async function Ie(){if(!G.value){alert("请填写完整的预约信息");return}F.value=!0;try{const s={petId:parseInt(l.value.petId),serviceId:parseInt(l.value.serviceId),appointmentDate:l.value.appointmentDate,timeSlot:l.value.timeSlot,specialNotes:l.value.specialNotes||"",careItems:l.value.careItems||[]};console.log("提交的预约数据:",s);const e=await _.createAppointment(s);console.log("预约结果:",e),R.value={orderNo:e.orderNo,appointmentDate:l.value.appointmentDate,timeSlot:l.value.timeSlot,totalAmount:e.totalAmount||H.value||0},U.value=!0,p.value&&p.value.length>0?l.value.petId=p.value[0].id.toString():l.value.petId="";const c=new Date;l.value.appointmentDate=$(c),l.value.timeSlot="",l.value.serviceId="",l.value.specialNotes="",l.value.careItems=[],N.value=null,h.value=[],await j(),await L(l.value.appointmentDate),await P()}catch(s){console.error("预约失败:",s),alert(s.message||"预约失败，请稍后重试")}finally{F.value=!1}}function Ae(){U.value=!1,V.push("/service/orders")}return ne(()=>l.value.appointmentDate,s=>{s&&l.value.timeSlot&&!te(l.value.timeSlot)&&(l.value.timeSlot="")}),ne(()=>_.isLoggedIn,s=>{s?(ee(),j(),P()):(p.value=[],y.value=[])}),Fe(async()=>{try{const s=_.checkAuthStatus();s||console.warn("用户未登录，部分功能受限"),s?await ee():p.value=[],await _e(),await he(),s?(await j(),await P()):y.value=[];const e=new Date;l.value.appointmentDate=$(e),await L(l.value.appointmentDate)}catch(s){console.error("初始化失败:",s)}}),Re(()=>{Y.value={}}),(s,e)=>{const c=Le("router-link");return o(),n(g,null,[t("div",Ye,[t("div",Oe,[t("div",He,[t("div",je,[e[16]||(e[16]=t("h2",null,[t("i",{class:"fas fa-plus-circle"}),d(" 创建新预约")],-1)),t("div",ze,[e[6]||(e[6]=t("label",{class:"form-label"},[t("i",{class:"fas fa-paw"}),d(" 选择宠物 ")],-1)),oe(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.petId=a),class:"form-control",disabled:r.value.pets},[e[3]||(e[3]=t("option",{value:""},"请选择您的宠物",-1)),(o(!0),n(g,null,w(p.value,a=>(o(),n("option",{key:a.id,value:a.id},i(a.name)+" ("+i(a.breed||"未知品种")+") ",9,Ge))),128))],8,qe),[[Ve,l.value.petId]]),r.value.pets?(o(),n("div",Je,[...e[4]||(e[4]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),d(" 加载中... ",-1)])])):v("",!0),!r.value.pets&&(!p.value||p.value.length===0)?(o(),n("div",Ke,[...e[5]||(e[5]=[d(" 暂无宠物，请先",-1),t("a",{href:"/pets/add"},"添加宠物",-1)])])):v("",!0)]),t("div",Qe,[e[11]||(e[11]=t("label",{class:"form-label"},[t("i",{class:"fas fa-calendar-day"}),d(" 选择预约日期 ")],-1)),t("div",We,[t("div",Xe,[t("h3",null,i(de.value),1),t("div",{class:"calendar-nav-main"},[t("button",{onClick:we,class:"nav-btn"},[...e[7]||(e[7]=[t("i",{class:"fas fa-chevron-left"},null,-1)])]),t("button",{onClick:Se,class:"today-btn"},"今天"),t("button",{onClick:Ce,class:"nav-btn"},[...e[8]||(e[8]=[t("i",{class:"fas fa-chevron-right"},null,-1)])])])]),t("div",Ze,[(o(),n(g,null,w(E,a=>t("div",{key:a,class:"weekday-cell"},i(a),1)),64))]),t("div",et,[(o(!0),n(g,null,w(ue.value,a=>(o(),n("div",{key:a.id,class:C(["calendar-day-main",{"other-month":!a.isCurrentMonth,today:a.isToday,selected:a.isSelected,"has-appointment":a.appointmentCount>0,disabled:K(a.date)}]),onClick:u=>be(a)},[t("div",st,i(a.date.getDate()),1),a.appointmentCount>0?(o(),n("div",at,[e[9]||(e[9]=t("div",{class:"appointment-dot"},null,-1)),t("span",nt,i(a.appointmentCount),1)])):v("",!0),a.isToday&&!a.isSelected?(o(),n("div",ot,"今")):v("",!0)],10,tt))),128))])]),l.value.appointmentDate?(o(),n("div",lt,[e[10]||(e[10]=t("i",{class:"fas fa-calendar-check"},null,-1)),d(" 已选择: "+i(pe(l.value.appointmentDate)),1)])):v("",!0)]),t("div",it,[e[14]||(e[14]=t("label",{class:"form-label"},[t("i",{class:"fas fa-clock"}),d(" 选择预约时间 ")],-1)),r.value.timeSlots?(o(),n("div",ct,[...e[12]||(e[12]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),d(" 加载可用时间段... ",-1)])])):(o(),n("div",rt,[(o(!0),n(g,null,w(z.value,a=>(o(),n("div",{key:a,class:C(["time-slot-main",{selected:l.value.timeSlot===a,disabled:!A.value.includes(a)}]),onClick:u=>ge(a)},[t("div",ut,[e[13]||(e[13]=t("i",{class:"far fa-clock"},null,-1)),t("span",vt,i(a),1),A.value.includes(a)?v("",!0):(o(),n("span",ft,"已满")),l.value.timeSlot===a?(o(),n("i",mt)):v("",!0)])],10,dt))),128))])),!r.value.timeSlots&&(!A.value||A.value.length===0)?(o(),n("div",pt," 该日期暂无可用时间段，请选择其他日期 ")):v("",!0)]),t("div",yt,[e[15]||(e[15]=t("label",{class:"form-label"},[t("i",{class:"fas fa-comment-alt"}),d(" 特殊要求 (可选) ")],-1)),oe(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.specialNotes=a),class:"form-control-textarea",rows:"3",placeholder:"请告知您的特殊要求，如对某些洗护用品过敏等",maxlength:"500"},null,512),[[Ue,l.value.specialNotes]]),t("div",_t,i(l.value.specialNotes?.length||0)+"/500 ",1)])])]),t("div",ht,[t("div",gt,[t("div",kt,[e[20]||(e[20]=t("label",{class:"form-label"},[t("i",{class:"fas fa-spa"}),d(" 选择洗护项目 ")],-1)),r.value.services?(o(),n("div",Dt,[...e[17]||(e[17]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),d(" 加载服务项目... ",-1)])])):(o(),n("div",bt,[(o(!0),n(g,null,w(I.value,a=>(o(),n("div",{key:a.id,class:C(["service-option-main",{selected:l.value.serviceId===a.id,recommended:a.isRecommended}]),onClick:u=>ke(a)},[t("div",Ct,[t("i",{class:C(ye(a.category))},null,2)]),t("div",St,[t("div",It,[t("h4",null,i(a.itemName),1),a.isRecommended?(o(),n("span",At,[...e[18]||(e[18]=[t("i",{class:"fas fa-star"},null,-1),d(" 推荐 ",-1)])])):v("",!0)]),t("p",Nt,i(a.briefDesc),1),t("div",$t,[t("div",Pt,[a.isDiscount?(o(),n("span",Mt," ¥"+i(a.basePrice),1)):v("",!0),t("span",xt," ¥"+i(a.finalPrice),1),a.isDiscount?(o(),n("span",Tt," -"+i(a.discountPercentage)+"% ",1)):v("",!0)]),t("div",Ft,[e[19]||(e[19]=t("i",{class:"far fa-clock"},null,-1)),t("span",null,"约"+i(a.duration)+"分钟",1)])])])],10,wt))),128))])),!r.value.services&&(!I.value||I.value.length===0)?(o(),n("div",Rt," 暂无可用服务 ")):v("",!0)]),t("div",Vt,[e[24]||(e[24]=t("label",{class:"form-label"},[t("i",{class:"fas fa-hand-sparkles"}),d(" 选择护理项目（可选） ")],-1)),r.value.careItems?(o(),n("div",Ut,[...e[21]||(e[21]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),d(" 加载护理项目... ",-1)])])):(o(),n("div",Lt,[(o(!0),n(g,null,w(ve.value,a=>(o(),n("div",{key:a},[t("h4",Bt,i(a),1),t("div",Et,[(o(!0),n(g,null,w(me(a),u=>(o(),n("div",{key:u.id,class:C(["care-item-main",{selected:J(u.id),free:u.unitPrice===0}]),onClick:M=>De(u)},[t("div",Ot,[t("h5",null,i(u.careName),1),u.unitPrice>0?(o(),n("div",Ht," ¥"+i(u.unitPrice),1)):(o(),n("div",jt,[...e[22]||(e[22]=[t("i",{class:"fas fa-gift"},null,-1),d(" 免费 ",-1)])]))]),t("p",zt,i(u.description),1),t("div",qt,[t("div",Gt,[J(u.id)?(o(),n("i",Jt)):(o(),n("i",Kt))])])],10,Yt))),128))])]))),128))])),h.value.length>0?(o(),n("div",Qt,[e[23]||(e[23]=t("i",{class:"fas fa-check-circle"},null,-1)),d(" 已选择 "+i(h.value.length)+" 项护理服务 ",1),t("span",Wt,"总计: ¥"+i(O.value),1)])):v("",!0)])])]),t("div",Xt,[N.value?(o(),n("div",Zt,[e[28]||(e[28]=t("div",{class:"summary-header"},[t("h4",null,[t("i",{class:"fas fa-receipt"}),d(" 费用明细")])],-1)),t("div",es,[t("div",ts,[e[25]||(e[25]=t("span",null,"服务费用：",-1)),t("span",null,"¥"+i(N.value.finalPrice),1)]),h.value.length>0?(o(),n("div",ss,[e[26]||(e[26]=t("span",null,"护理项目：",-1)),t("span",null,"¥"+i(O.value),1)])):v("",!0),t("div",as,[e[27]||(e[27]=t("span",null,"总计：",-1)),t("span",ns,"¥"+i(H.value),1)])])])):v("",!0),t("button",{class:"btn-submit-main",disabled:!G.value||F.value,onClick:Ie},[F.value?(o(),n("i",ls)):(o(),n("i",is)),d(" "+i(F.value?"提交中...":"确认预约")+" ",1),N.value?(o(),n("span",cs,"¥"+i(H.value),1)):v("",!0)],8,os)])]),t("div",rs,[t("div",ds,[e[30]||(e[30]=t("h3",null,[t("i",{class:"fas fa-history"}),d(" 我的预约记录")],-1)),le(c,{to:"/service/orders",class:"view-all-link"},{default:ie(()=>[...e[29]||(e[29]=[d(" 查看全部 ",-1),t("i",{class:"fas fa-arrow-right"},null,-1)])]),_:1})]),!r.value.appointments&&y.value&&y.value.length>0?(o(),n("div",us,[t("div",vs,[t("div",fs,[(o(!0),n(g,null,w(ce.value,a=>(o(),n("div",{key:a.id,class:C(["appointment-history-card","compact-card",`status-${a.status}`])},[t("div",ms,[t("div",ps,[t("span",ys,"#"+i(a.orderNo),1),t("span",{class:C(["status-badge",a.status])},i(W(a.status)),3)]),t("div",_s,[e[31]||(e[31]=t("i",{class:"far fa-calendar"},null,-1)),d(" "+i(Q(a.appointmentDate))+" "+i(a.timeSlot),1)])]),t("div",hs,[t("div",gs,[e[33]||(e[33]=t("i",{class:"fas fa-spa"},null,-1)),t("div",ks,[t("h4",null,i(a.serviceName),1),t("div",Ds,[e[32]||(e[32]=t("i",{class:"fas fa-paw"},null,-1)),t("span",null,i(a.petName),1)])])]),t("div",bs,[t("div",ws,[e[34]||(e[34]=t("i",{class:"fas fa-yen-sign"},null,-1)),t("span",Cs,"¥"+i(a.orderTotalAmount),1)])])]),t("div",Ss,[t("button",{class:"btn-view-detail compact-btn",onClick:u=>X(a.id)},[...e[35]||(e[35]=[t("i",{class:"fas fa-eye"},null,-1),d(" 详情 ",-1)])],8,Is),a.status==="pending"?(o(),n("button",{key:0,class:"btn-cancel-appointment compact-btn",onClick:u=>se(a)},[...e[36]||(e[36]=[t("i",{class:"fas fa-times"},null,-1),d(" 取消 ",-1)])],8,As)):v("",!0),a.status==="completed"&&!a.reviewed?(o(),n("button",{key:1,class:"btn-review compact-btn",onClick:u=>Z(a.id)},[...e[37]||(e[37]=[t("i",{class:"fas fa-star"},null,-1),d(" 评价 ",-1)])],8,Ns)):v("",!0)])],2))),128))])]),t("div",$s,[t("div",Ps,[(o(!0),n(g,null,w(re.value,a=>(o(),n("div",{key:a.id,class:C(["appointment-history-card","compact-card",`status-${a.status}`])},[t("div",Ms,[t("div",xs,[t("span",Ts,"#"+i(a.orderNo),1),t("span",{class:C(["status-badge",a.status])},i(W(a.status)),3)]),t("div",Fs,[e[38]||(e[38]=t("i",{class:"far fa-calendar"},null,-1)),d(" "+i(Q(a.appointmentDate))+" "+i(a.timeSlot),1)])]),t("div",Rs,[t("div",Vs,[e[40]||(e[40]=t("i",{class:"fas fa-spa"},null,-1)),t("div",Us,[t("h4",null,i(a.serviceName),1),t("div",Ls,[e[39]||(e[39]=t("i",{class:"fas fa-paw"},null,-1)),t("span",null,i(a.petName),1)])])]),t("div",Bs,[t("div",Es,[e[41]||(e[41]=t("i",{class:"fas fa-yen-sign"},null,-1)),t("span",Ys,"¥"+i(a.orderTotalAmount),1)])])]),t("div",Os,[t("button",{class:"btn-view-detail compact-btn",onClick:u=>X(a.id)},[...e[42]||(e[42]=[t("i",{class:"fas fa-eye"},null,-1),d(" 详情 ",-1)])],8,Hs),a.status==="pending"?(o(),n("button",{key:0,class:"btn-cancel-appointment compact-btn",onClick:u=>se(a)},[...e[43]||(e[43]=[t("i",{class:"fas fa-times"},null,-1),d(" 取消 ",-1)])],8,js)):v("",!0),a.status==="completed"&&!a.reviewed?(o(),n("button",{key:1,class:"btn-review compact-btn",onClick:u=>Z(a.id)},[...e[44]||(e[44]=[t("i",{class:"fas fa-star"},null,-1),d(" 评价 ",-1)])],8,zs)):v("",!0)])],2))),128))])])])):r.value.appointments?(o(),n("div",qs,[...e[45]||(e[45]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),d(" 加载预约记录... ",-1)])])):(o(),n("div",Gs,[...e[46]||(e[46]=[t("div",{class:"empty-icon"},[t("i",{class:"fas fa-calendar-times"})],-1),t("p",{class:"empty-text"},"暂无预约记录",-1),t("p",{class:"empty-subtext"},"开始您的第一次宠物洗护预约吧",-1)])])),y.value.length>0?(o(),n("div",Js,[le(c,{to:"/service/orders",class:"btn-load-more-link"},{default:ie(()=>[t("button",{class:"btn-load-more",onClick:Ee(fe,["prevent"]),disabled:q.value},[q.value?(o(),n("i",Qs)):(o(),n("span",Ws,"加载更多记录"))],8,Ks)]),_:1})])):v("",!0)])]),U.value?(o(),n("div",Xs,[t("div",Zs,[e[54]||(e[54]=t("div",{class:"modal-header"},[t("i",{class:"fas fa-check-circle success-icon"}),t("h3",null,"预约成功！")],-1)),t("div",ea,[t("div",ta,[t("div",sa,[e[48]||(e[48]=t("i",{class:"fas fa-receipt"},null,-1)),t("div",null,[e[47]||(e[47]=t("div",{class:"detail-label"},"订单编号",-1)),t("div",aa,i(R.value.orderNo),1)])]),t("div",na,[e[50]||(e[50]=t("i",{class:"far fa-calendar"},null,-1)),t("div",null,[e[49]||(e[49]=t("div",{class:"detail-label"},"预约时间",-1)),t("div",oa,i(R.value.appointmentDate)+" "+i(R.value.timeSlot),1)])]),t("div",la,[e[52]||(e[52]=t("i",{class:"fas fa-yen-sign"},null,-1)),t("div",null,[e[51]||(e[51]=t("div",{class:"detail-label"},"支付金额",-1)),t("div",ia,"¥"+i(R.value.totalAmount),1)])])]),e[53]||(e[53]=t("p",{class:"success-tip"},' 您可以在"我的预约"中查看预约详情和取消预约 ',-1))]),t("div",ca,[t("button",{class:"btn-secondary",onClick:Ae},"查看我的预约"),t("button",{class:"btn-primary",onClick:e[2]||(e[2]=a=>U.value=!1)},"继续预约")])])])):v("",!0)],64)}}},fa=xe(ra,[["__scopeId","data-v-6da3ab63"]]);export{fa as default};
